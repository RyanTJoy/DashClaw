{
  "framework": "SOC 2",
  "version": "2017",
  "description": "AICPA Trust Service Criteria for agent operations",
  "last_updated": "2026-02-15",
  "controls": [
    {
      "id": "CC6.1",
      "category": "Logical and Physical Access Controls",
      "title": "Logical Access Security",
      "description": "The entity implements logical access security software, infrastructure, and architectures over protected information assets to protect them from security events.",
      "agent_relevance": "high",
      "policy_mappings": [
        {
          "policy_pattern": "block",
          "tool_patterns": ["exec.*", "fs.delete", "fs.rmdir", "db.drop", "db.truncate"],
          "coverage": "full",
          "rationale": "Blocking destructive operations and shell execution prevents unauthorized system modification"
        },
        {
          "policy_pattern": "allowlist",
          "tool_patterns": ["exec.*"],
          "coverage": "full",
          "rationale": "Command allowlisting restricts agent capabilities to explicitly permitted operations"
        }
      ],
      "evidence_queries": {
        "guard_decisions": "decision IN ('block') AND action_type IN ('exec', 'file.delete', 'db.drop')",
        "description": "Count of blocked destructive operations"
      },
      "gap_recommendations": [
        "Add a policy that blocks or restricts shell command execution",
        "Add a policy that blocks destructive file and database operations",
        "Consider command allowlisting instead of blanket blocking"
      ]
    },
    {
      "id": "CC6.2",
      "category": "Logical and Physical Access Controls",
      "title": "Authentication and Access Credentials",
      "description": "Prior to issuing system credentials and granting system access, the entity registers and authorizes new internal and external users.",
      "agent_relevance": "high",
      "policy_mappings": [
        {
          "policy_pattern": "require_approval",
          "tool_patterns": ["*"],
          "coverage": "partial",
          "rationale": "Approval workflows ensure human authorization before sensitive agent actions"
        }
      ],
      "evidence_queries": {
        "guard_decisions": "decision = 'require_approval'",
        "description": "Approval gate enforcement count"
      },
      "gap_recommendations": [
        "Ensure agents authenticate via API keys (DashClaw handles this)",
        "Use identity binding (cryptographic agent identity) for high-security environments",
        "Rotate agent API keys on a defined schedule"
      ]
    },
    {
      "id": "CC6.3",
      "category": "Logical and Physical Access Controls",
      "title": "Access Removal",
      "description": "The entity authorizes, modifies, or removes access to data, software, functions, and other protected information assets based on roles.",
      "agent_relevance": "medium",
      "policy_mappings": [
        {
          "policy_pattern": "block",
          "tool_patterns": ["*"],
          "coverage": "partial",
          "rationale": "Policy-based blocking effectively removes agent access to specific capabilities"
        }
      ],
      "evidence_queries": {
        "description": "API key revocation events and policy deactivation logs"
      },
      "gap_recommendations": [
        "Implement agent API key rotation and revocation procedures",
        "Document agent capability removal process",
        "Use DashClaw team management to control agent access"
      ]
    },
    {
      "id": "CC6.6",
      "category": "Logical and Physical Access Controls",
      "title": "External System Interfaces",
      "description": "The entity implements controls to prevent or detect and act upon the introduction of unauthorized or malicious software.",
      "agent_relevance": "critical",
      "policy_mappings": [
        {
          "policy_pattern": "require_approval",
          "tool_patterns": ["message.send", "email.send", "web.post", "slack.post", "sms.send"],
          "coverage": "full",
          "rationale": "Approval gates on external communications prevent unauthorized outbound data transfer"
        },
        {
          "policy_pattern": "block",
          "tool_patterns": ["web.fetch", "web.post"],
          "coverage": "full",
          "rationale": "Domain restrictions on web requests prevent unauthorized external system access"
        }
      ],
      "evidence_queries": {
        "guard_decisions": "action_type IN ('email.send', 'message.send', 'web.post')",
        "description": "External communication approval and block counts"
      },
      "gap_recommendations": [
        "Add approval requirement for all external communications",
        "Implement domain allowlisting for web requests",
        "Use DashClaw webhook governance to track outbound integrations"
      ]
    },
    {
      "id": "CC6.7",
      "category": "Logical and Physical Access Controls",
      "title": "Data Classification and Protection",
      "description": "The entity restricts the transmission, movement, and removal of information to authorized internal and external users and processes.",
      "agent_relevance": "critical",
      "policy_mappings": [
        {
          "policy_pattern": "block",
          "tool_patterns": ["data.export", "data.download"],
          "coverage": "full",
          "rationale": "Blocking data export prevents unauthorized data exfiltration"
        },
        {
          "policy_pattern": "require_approval",
          "tool_patterns": ["data.export", "report.generate"],
          "coverage": "full",
          "rationale": "Approval gates on data export ensure human oversight of data movement"
        }
      ],
      "evidence_queries": {
        "description": "Data export approval/denial counts and DLP scan results"
      },
      "gap_recommendations": [
        "Add policies requiring approval for data exports",
        "Enable DashClaw DLP scanning for sensitive data patterns",
        "Implement data classification labels on agent-accessible data"
      ]
    },
    {
      "id": "CC7.1",
      "category": "System Operations",
      "title": "Detection of Changes",
      "description": "To meet its objectives, the entity uses detection and monitoring procedures to identify changes to configurations and new vulnerabilities.",
      "agent_relevance": "high",
      "policy_mappings": [
        {
          "policy_pattern": "rate_limit",
          "tool_patterns": ["*"],
          "coverage": "partial",
          "rationale": "Rate limiting detects unusual spikes in agent activity that may indicate compromise"
        }
      ],
      "evidence_queries": {
        "guard_decisions": "decision = 'warn' OR decision = 'block'",
        "description": "Signal detection and anomaly warning counts"
      },
      "gap_recommendations": [
        "Add rate limiting policies to detect anomalous agent behavior",
        "Enable DashClaw signal detection (autonomy_spike, repeated_failures)",
        "Configure webhook alerts for new risk signals",
        "Consider behavioral_anomaly policy type for pattern-based detection"
      ]
    },
    {
      "id": "CC7.2",
      "category": "System Operations",
      "title": "Monitoring System Components",
      "description": "The entity monitors system components and the operation of those components for anomalies and indicators of compromise.",
      "agent_relevance": "critical",
      "policy_mappings": [
        {
          "policy_pattern": "any_active_policy",
          "tool_patterns": ["*"],
          "coverage": "partial",
          "rationale": "Active guard policies with decision logging provide continuous monitoring of agent operations"
        }
      ],
      "evidence_queries": {
        "guard_decisions": "COUNT(*) as total_evaluations",
        "description": "Total guard evaluations (demonstrates active monitoring)"
      },
      "gap_recommendations": [
        "Ensure at least one guard policy is active and logging decisions",
        "Enable DashClaw signal detection cron for automated governance",
        "Configure email/webhook alerts for critical signals",
        "Review guard decision logs at least monthly"
      ]
    },
    {
      "id": "CC7.3",
      "category": "System Operations",
      "title": "Evaluation of Security Events",
      "description": "The entity evaluates detected events to determine whether they could or have resulted in a failure of the entity to meet its objectives.",
      "agent_relevance": "high",
      "policy_mappings": [],
      "evidence_queries": {
        "description": "Signal evaluation and dismissal history from DashClaw security page"
      },
      "gap_recommendations": [
        "Establish a process for reviewing DashClaw security signals",
        "Document signal triage and escalation procedures",
        "Assign security signal review to a team member (weekly minimum)"
      ]
    },
    {
      "id": "CC8.1",
      "category": "Change Management",
      "title": "Changes to Infrastructure and Software",
      "description": "The entity authorizes, designs, develops, configures, documents, tests, approves, and implements changes to infrastructure and software.",
      "agent_relevance": "high",
      "policy_mappings": [
        {
          "policy_pattern": "dry_run",
          "tool_patterns": ["*"],
          "coverage": "full",
          "rationale": "Policy dry-run mode enables safe testing of changes before enforcement"
        }
      ],
      "evidence_queries": {
        "description": "Policy change history and dry-run evaluation logs"
      },
      "gap_recommendations": [
        "Use policy dry-run mode to test changes before enforcement",
        "Use policy simulator to estimate impact of new policies",
        "Maintain policy version history (DashClaw policy changelog)",
        "Run guardrailgen CI tests on policy changes"
      ]
    },
    {
      "id": "CC9.1",
      "category": "Risk Mitigation",
      "title": "Risk Assessment and Identification",
      "description": "The entity identifies, selects, and develops risk mitigation activities.",
      "agent_relevance": "high",
      "policy_mappings": [
        {
          "policy_pattern": "risk_threshold",
          "tool_patterns": ["*"],
          "coverage": "full",
          "rationale": "Risk threshold policies automatically identify and mitigate high-risk agent actions"
        }
      ],
      "evidence_queries": {
        "guard_decisions": "risk_score IS NOT NULL",
        "description": "Risk-scored guard evaluations"
      },
      "gap_recommendations": [
        "Add a risk_threshold policy (recommended: warn at 70, block at 85)",
        "Enable DashClaw risk scoring on action records",
        "Review high-risk actions monthly and adjust thresholds"
      ]
    }
  ]
}
